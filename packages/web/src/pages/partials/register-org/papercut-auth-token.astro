---
import { boolean, fallback, parse, pick } from "valibot";

import RegisterOrgPaperCutAuthToken from "~/components/register-org/papercut-auth-token.astro";
import { Registration } from "~/lib/schemas";

export const partial = true;

const formData = await Astro.request.formData();
const { authToken: value } = parse(
  fallback(pick(Registration, ["authToken"]), { authToken: "" }),
  Object.fromEntries(formData.entries()),
);

const show = parse(
  fallback(boolean(), false),
  Astro.url.searchParams.get("show") === "true",
);
---

<RegisterOrgPaperCutAuthToken {value} {show} />
