---
import { boolean, fallback, parse, pick } from "valibot";

import RegisterOrgPapercutAuthToken from "~/components/register-org/papercut-auth-token.astro";
import { registrationSchema } from "~/lib/schemas";

export const partial = true;

const formData = await Astro.request.formData();
const { authToken: value } = parse(
  fallback(pick(registrationSchema, ["authToken"]), { authToken: "" }),
  Object.fromEntries(formData.entries()),
);

const show = parse(
  fallback(boolean(), false),
  Astro.url.searchParams.get("show") === "true",
);
---

<RegisterOrgPapercutAuthToken {value} {show} />
