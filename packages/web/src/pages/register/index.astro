---
import Logo from "~/components/logo.astro";
import OrgProviderId from "~/components/org/provider-id.astro";
import OrgSlug from "~/components/org/slug.astro";
import PapercutAuthToken from "~/components/papercut/auth-token.astro";
import Layout from "~/layouts/layout.astro";
import { buttonStyles } from "~/shared/styles/components/primitives/button";
import { labelStyles } from "~/shared/styles/components/primitives/field";
import { inputStyles } from "~/shared/styles/components/primitives/input";
import { selectStyles } from "~/shared/styles/components/primitives/select";
---

<Layout title="Register" htmx>
  <div class="w-full lg:grid lg:min-h-[600px] lg:grid-cols-2 xl:min-h-[800px]">
    <form
      action="/api/organization"
      method="POST"
      class="flex items-center justify-center py-12"
    >
      <div class="mx-auto grid w-[350px] gap-6">
        <div class="flex justify-center">
          <a href="/">
            <div class="flex h-24 w-20 items-center overflow-hidden">
              <Logo />
            </div>
          </a>
        </div>

        <div class="grid gap-2 text-center">
          <h1 class="text-3xl font-bold">Register</h1>
          <p class="text-balance text-muted-foreground">
            Register your organization details below.
          </p>
        </div>

        <div class="grid gap-4">
          <div class="grid gap-2">
            <label class={labelStyles()} for="name">Full Name</label>
            <input
              id="name"
              name="name"
              class={inputStyles({ isHtml: true })}
              placeholder="My Organization"
              required
            />
          </div>

          <OrgSlug />

          <div class="grid gap-2">
            <label class={labelStyles()} for="auth-provider"
              >Auth Provider</label
            >
            <select
              id="auth-provider"
              name="authProvider"
              class={selectStyles({
                isHtml: true,
                class:
                  "border-0 border-r-8 border-transparent outline-input outline-1 outline",
              })}
              required
              hx-get="/partials/org/provider-id"
              hx-target="#provider-id"
              hx-swap-oob="outerHTML"
            >
              <option value="entra-id">Microsoft Entra ID</option>
              <option value="google">Google</option>
            </select>
          </div>

          <OrgProviderId />

          <div class="grid gap-2">
            <label class={labelStyles()} for="server-url"
              >PaperCut XML Web Services API URL</label
            >
            <input
              id="server-url"
              name="serverUrl"
              type="url"
              class={inputStyles({ isHtml: true })}
              placeholder="https://[server_name]:9192/rpc/api/xmlrpc"
              required
            />
          </div>

          <PapercutAuthToken />

          <button
            type="submit"
            class={buttonStyles({ class: "w-full gap-2 mt-4", isHtml: true })}
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="size-5"
            >
              <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path>
              <path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path>
              <path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path>
              <path d="M10 6h4"></path><path d="M10 10h4"></path>
              <path d="M10 14h4"></path>
              <path d="M10 18h4"></path>
            </svg>
            Register</button
          >
        </div>

        <p class="text-sm">
          Already have an organization? <a
            href="/login"
            class={buttonStyles({
              variant: "link",
              class: "p-0 h-fit",
              isHtml: true,
            })}>Login</a
          >
        </p>
      </div>
    </form>

    <div class="hidden bg-muted lg:block lg:max-h-screen topography"></div>
  </div>
</Layout>

<style>
  .topography {
    background-image: url("/topography.svg");
    background-repeat: repeat;
  }
</style>
